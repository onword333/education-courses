# Агрегация данных

## Задание 1
Выведите id всех уникальных пользователей из таблицы user_actions. Результат отсортируйте по возрастанию id.

Поле в результирующей таблице: user_id

Решение:

    SELECT
        DISTINCT user_id
    FROM user_actions
    ORDER BY
    user_id ASC

## Задание 2
Примените DISTINCT сразу к двум колонкам таблицы courier_actions и отберите уникальные пары значений courier_id и order_id.

Результат отсортируйте сначала по возрастанию id курьера, затем по возрастанию id заказа.

Поля в результирующей таблице: courier_id, order_id

Решение:

    SELECT DISTINCT 
      courier_id, 
      order_id
    FROM courier_actions
    ORDER BY
        courier_id ASC,
        order_id ASC

## Задание 3
Посчитайте максимальную и минимальную цены товаров в таблице products. Поля назовите соответственно max_price, min_price.

Поля в результирующей таблице: max_price, min_price

Пояснение:

В одном запросе можно использовать сразу несколько агрегирующих функций — если необходимо, то даже по нескольким разным колонкам.

Решение:

    SELECT
        MIN(price) AS min_price,
        MAX(price) AS max_price
    FROM products

## Задание 4
Как вы помните, в таблице users у некоторых пользователей не были указаны их даты рождения.

Посчитайте в одном запросе количество всех записей в таблице и количество только тех записей, для которых в колонке birth_date указана дата рождения.

Колонку с общим числом записей назовите dates, а колонку с записями без пропусков — dates_not_null.

Поля в результирующей таблице: dates, dates_not_null

Решение:

    SELECT
        COUNT(*) AS dates, 
        COUNT(birth_date) AS dates_not_null
    FROM users

## Задание 5
Посчитайте количество всех значений в колонке user_id в таблице user_actions, а также количество уникальных значений в этой колонке (т.е. количество уникальных пользователей сервиса).

Колонку с первым полученным значением назовите users, а колонку со вторым — unique_users.

Поля в результирующей таблице: users, unique_users

Решение:

    SELECT
        COUNT(user_id) AS users, 
        COUNT(DISTINCT user_id) AS unique_users
    FROM user_actions

## Задание 6
Посчитайте количество курьеров женского пола в таблице couriers. Полученный столбец с одним значением назовите couriers.

Поле в результирующей таблице: couriers

Решение:

    SELECT
        COUNT(courier_id) AS couriers
    FROM couriers
    WHERE sex = 'female'

## Задание 7
Рассчитайте время, когда были совершены первая и последняя доставки заказов в таблице courier_actions.

Колонку с временем первой доставки назовите first_delivery, а колонку с временем последней — last_delivery.

Поля в результирующей таблице: first_delivery, last_delivery

Пояснение:

Обратите внимание, что в таблице с действиями курьеров есть не только записи с временем доставки заказов, но и записи с временем их принятия. 

Решение:

    SELECT
        MIN(time) AS first_delivery, 
        MAX(time) AS last_delivery
    FROM courier_actions
    WHERE action = 'deliver_order'
