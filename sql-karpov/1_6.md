# Группировка данных
## Задание 1
С помощью оператора GROUP BY посчитайте количество курьеров мужского и женского пола в таблице couriers.

Новую колонку с числом курьеров назовите couriers_count.

Результат отсортируйте по этой колонке по возрастанию.

Поля в результирующей таблице: sex, couriers_count

Решение:

    SELECT
        sex,
        COUNT(DISTINCT courier_id) AS couriers_count
    FROM couriers
    GROUP BY
        sex

## Задание 2
Теперь давайте аналогичным образом выясним, сколько всего было сделано заказов и сколько из них было отменено за всё время работы нашего сервиса.

Задание:

Посчитайте количество созданных и отменённых заказов в таблице user_actions.

Новую колонку с числом заказов назовите orders_count.

Результат отсортируйте по числу заказов по возрастанию.

Поля в результирующей таблице: action, orders_count

Решение:

    SELECT
        action,
        COUNT(order_id) AS orders_count
    FROM user_actions
    GROUP BY
        action
    ORDER BY
        COUNT(order_id)

## Задание 3
Используя группировку и функцию DATE_TRUNC, приведите все даты к началу месяца и посчитайте, сколько заказов было сделано в каждом из них.

Расчёты проведите по таблице orders. Колонку с усечённой датой назовите month, колонку с количеством заказов — orders_count.

Результат отсортируйте по месяцам — по возрастанию.

Поля в результирующей таблице: month, orders_count

Пояснение:

Обратите внимание, что в данной задаче вам необходимо провести группировку по новому расчётному полю.

В этой ситуации важно помнить, что колонки, указанные в SELECT, должны находиться и в GROUP BY (если они не используются в агрегационных функциях). При этом в GROUP BY допускается использование алиаса колонки, указанного в блоке SELECT, т.е. повторно производить вычисления в GROUP BY не обязательно.

Решение:

    SELECT
       DATE_TRUNC('month', creation_time) AS month,
       COUNT(order_id) AS orders_count
    FROM orders
    GROUP BY
        month
    ORDER BY
        month
