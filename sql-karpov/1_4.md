# Фильтрация данныъ

## Задание 1
Напишите SQL-запрос к таблице products и выведите всю информацию о товарах, цена которых не превышает 100 рублей. Результат отсортируйте по возрастанию id товара.

Поля в результирующей таблице: product_id, name, price

Решение:

    SELECT product_id,
           name,
           price
    FROM   products
    WHERE  price <= 100
    ORDER BY product_id

## Задание 2
Отберите пользователей женского пола из таблицы users. Выведите только id этих пользователей. Результат отсортируйте по возрастанию id.

Добавьте в запрос оператор LIMIT и выведите только 1000 первых id из отсортированного списка.

Поле в результирующей таблице: user_id

Решение:

    SELECT
        user_id
    FROM users
    WHERE sex = 'female'
    ORDER BY
        user_id
    LIMIT 1000

## Задание 3
Отберите из таблицы user_actions все действия пользователей по созданию заказов, которые были совершены ими после полуночи 6 сентября 2022 года. Выведите колонки с id пользователей, id созданных заказов и временем их создания.

Результат должен быть отсортирован по возрастанию id заказа.

Поля в результирующей таблице: user_id, order_id, time

Решение:

    SELECT    
        user_id,
        order_id,
        time
    FROM user_actions
    WHERE CAST(time AS DATE) >= '2022-09-06 00:00:00' AND action = 'create_order'
    ORDER BY
        order_id

## Задание 4
Назначьте скидку 20% на все товары из таблицы products и отберите те, цена на которые с учётом скидки превышает 100 рублей. Выведите id товаров, их наименования, прежнюю цену и новую цену с учётом скидки. Колонку со старой ценой назовите old_price, с новой — new_price.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: product_id, name, old_price, new_price

Решение:

    SELECT
        price * 0.80 AS new_price,
        price AS old_price,
        product_id,
        name
    FROM products
    WHERE (price * 0.80) > 100
    ORDER BY
        product_id

## Задание 5
Отберите из таблицы products все товары, названия которых либо начинаются со слова «чай», либо состоят из пяти символов. Выведите две колонки: id товаров и их наименования.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: product_id, name

Решение:

    SELECT
        product_id,
        name
    FROM products
    WHERE SPLIT_PART(name, ' ', 1) = 'чай' OR LENGTH(name) = 5
    ORDER BY
        product_id

## Задание 6
Отберите из таблицы products все товары, содержащие в своём названии последовательность символов «чай» (без кавычек). Выведите две колонки: id продукта и его название.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: product_id, name

Решение:

    SELECT
        product_id,
        name
    FROM products
    WHERE name LIKE '%чай%'
    ORDER BY
        product_id

## Задание 7
Выберите из таблицы products id и наименования только тех товаров, названия которых начинаются на букву «с» и содержат только одно слово.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: product_id, name

Решение:

    SELECT
        product_id,
        name
    FROM products
    WHERE name LIKE 'с%' AND name not LIKE '% %'
    ORDER BY
        product_id

## Задание 8
Составьте SQL-запрос, который выбирает из таблицы products все чаи стоимостью больше 60 рублей и вычисляет для них цену со скидкой 25%.

Скидку в % менеджер попросил указать в отдельном столбце в формате текста, то есть вот так: «25%» (без кавычек). Столбцы со скидкой и новой ценой назовите соответственно discount и new_price.

Также необходимо любым известным способом избавиться от «чайного гриба»: вряд ли менеджер имел в виду и его, когда ставил нам задачу.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: product_id, name, price, discount, new_price

Решение:

    SELECT
        product_id,
        name,
        price,
        price * 0.75 AS new_price,
        '25%' AS discount
    FROM products
    WHERE 
        name LIKE '%чай%' 
        AND price > 60 
        AND name NOT LIKE '%чайный гриб%'
    ORDER BY
        product_id
