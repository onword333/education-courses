# JOIN - основные типы объединений
## Задание 1
Объедините таблицы user_actions и users по ключу user_id. В результат включите две колонки с user_id из обеих таблиц. Эти две колонки назовите соответственно user_id_left и user_id_right. Также в результат включите колонки order_id, time, action, sex, birth_date. Отсортируйте получившуюся таблицу по возрастанию id пользователя (в любой из двух колонок с id).

Поля в результирующей таблице: user_id_left, user_id_right,  order_id, time, action, sex, birth_date

Пояснение:

Обратите внимание, что в результате объединения колонки с ключами (в нашем случае это user_id) не превращаются в одну общую колонку, а вместе добавляются в результирующую таблицу. То есть сколько было суммарно колонок в двух таблицах, столько окажется и в результирующей таблице после объединения. А уже далее в операторе SELECT можно выбирать нужные и проводить над ними операции.

Чтобы обратиться к колонкам с одинаковым именем (user_id), пришедшим из разных таблиц, назначьте таблицам алиасы и обратитесь к колонкам через них. Пример, как это можно сделать:

    SELECT A.id as id_a, 
           B.id as id_b, 
           ...
    FROM table_A as A
         JOIN table_B as B
         ON A.id = B.id
    ...

После того как решите задачу, обратите внимание на колонки с user_id. Все ли значения в них попарно совпадают?

Решение:

    SELECT
      ua.user_id AS user_id_left,
      u.user_id AS user_id_right,
      ua.order_id AS order_id,
      ua.time AS time,
      ua.action AS action,
      u.sex AS sex,
      u.birth_date AS birth_date
    FROM
      user_actions ua
      INNER JOIN users u ON ua.user_id = u.user_id
    ORDER BY
      u.user_id

## Задание 2
А теперь попробуйте немного переписать запрос из прошлого задания и посчитать количество уникальных id в объединённой таблице. То есть снова объедините таблицы, но в этот раз просто посчитайте уникальные user_id в одной из колонок с id. Выведите это количество в качестве результата. Колонку с посчитанным значением назовите users_count.

Поле в результирующей таблице: users_count

После того как решите задачу, сравните полученное значение с количеством уникальных пользователей в таблицах users и user_actions, которое мы посчитали на прошлом шаге. С каким значением оно совпадает ?

Решение:

    SELECT
      COUNT(DISTINCT ua.user_id) AS users_count
    FROM
      user_actions ua
      INNER JOIN users u ON ua.user_id = u.user_id

## Задание 3
С помощью LEFT JOIN объедините таблицы user_actions и users по ключу user_id. Обратите внимание на порядок таблиц — слева users_actions, справа users. В результат включите две колонки с user_id из обеих таблиц. Эти две колонки назовите соответственно user_id_left и user_id_right. Также в результат включите колонки order_id, time, action, sex, birth_date. Отсортируйте получившуюся таблицу по возрастанию id пользователя (в колонке из левой таблицы).

Поля в результирующей таблице: user_id_left, user_id_right,  order_id, time, action, sex, birth_date

После того как решите задачу, обратите внимание на колонки с user_id. Нет ли в какой-то из них пропущенных значений?

Решение:

    SELECT
      ua.user_id AS user_id_left,
      u.user_id AS user_id_right,
      ua.order_id AS order_id,
      ua.time AS time,
      ua.action AS action,
      u.sex AS sex,
      u.birth_date AS birth_date
    FROM
      user_actions ua
      LEFT JOIN users u ON ua.user_id = u.user_id
    ORDER BY
      ua.user_id
